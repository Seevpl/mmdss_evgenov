# Лабораторная работа 4
Метод Пиявского.
## Цель работы
Разработка программы по нахождению глобального экстремума липшицевой функции с помощью метода ломаных (Пиявского).
## Задачи
1. Выбор функции для нахождения глобального экстремума,
2. Парсинг функции,
3. Реализация метода ломаных (Пиявского),
4. Применение разработанной программы к заданной функции на заданном отрезке,
5. Сравнение работы разработанной программы с модулем "Поиск решения" в MS Excel.
## Описание модели
Для нахождения экстремума была выбрана функция "Lévi function N.13". Для приведения её к одномерности, переменной $y$ было присвоено значение 3. Общее выражение функции: $f(x, y) = sin^23\pi x + (x - 1)^2(1 + sin^23\pi y) + (y - 1)^2(1 + sin^22\pi y)$. При $y = 3$, данная функция приобретает следующий вид: $f(x) = sin^23\pi x + (x - 1)^2(1 + sin^29\pi) + 4(1 + sin^26\pi)$. Функция будет анализироваться на промежутке $[-1, 2]$. График функции на данном промежутке:\
![Screenshot of the function graph](/lab4/img0.png)\
По графику функции визуально можно определить, что данный промежуток включает точно больше 10 локальных экстремумов, таким образом он подходит по условию работы.\
Модель принимает данную функцию и отрезок для поиска экстремума. Затем применяет к данной функции на данном отрезке метод Пиявского, то есть итерационно строит ломаную линию-миноранту, пока в минимальной точке функции миноранта не становится приближена к ней ближе, чем установленная заранее погрешность. После этого модель завершает работу, отображает график исходной функции и миноранты и выдаёт точку-глобальный экстремум.
## Обобщённый алгоритм модели
Модель работает следующим образом:
1. Принимает выражение функции (записанное в текстовом формате), числа начала и окончания отрезка и точность вычисления экстремума.
2. Парсит принятую функцию и превращает её в функцию на языке Python (с помощью библиотеки sympy).
3. Вычисляет константу Липшица для данной функции на данном отрезке. Константа Липшица вычисляется, исходя из следующей формулы: $|W(u) - W(v)| \leq L|u - v|$, где $a \leq u, v \leq b$ - любые два значения $x$ из заданного заранее промежутка, $W(x)$ - рассматриваемая функция, $L$ - собственно константа Липшица для данной $W(x)$ на заданном промежутке $[a, b]$.
4. Строит первые две линии, которые будут основой дальнейшего построения миноранты по следующей общей формуле: $g_i(x) = W(x*) - L|x - x*|$, где $i = 0, 1, ...$ - порядковый номер вспомогательной линии, $x*$ - рассматриваемое в данный момент значение переменной $x$. Для построения $g_0$ и $g_1$ в качестве $x*$ берутся концы отрезка $a$ и $b$ соответственно.
## Скриншоты работы программы

![Screenshot of the plots](/lab2/img2.png)\